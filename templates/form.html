<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saarthi | Service Portal</title>
    
    <!-- Tailwind & Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'flag-navy': '#000080',
                        'flag-saffron': '#FF9933',
                        'flag-green': '#138808',
                        'slate-custom': '#334155'
                    },
                    fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'] }
                }
            }
        }
    </script>

    <style>
        /* DASHBOARD SYNCED BACKGROUND */
        body { 
            background-color: #f8fafc;
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 32px 32px; /* Matches dashboard dot grid */
        }

        /* DASHBOARD GRADIENTS */
        .grad-orange { background: linear-gradient(135deg, #FFD56B 0%, #FF9933 100%); }
        .grad-navy { background: linear-gradient(135deg, #334155 0%, #000080 100%); }
        .grad-blue { background: linear-gradient(135deg, #60a5fa 0%, #2563eb 100%); }
        .grad-green { background: linear-gradient(135deg, #4ade80 0%, #138808 100%); }

        /* DASHBOARD CARD STYLE */
        .saarthi-card {
            background: #FFFFFF;
            border-radius: 28px;
            box-shadow: 0 10px 30px -5px rgba(0, 0, 128, 0.05);
            border: 1px solid #edf2f7;
        }

        .icon-circle {
            width: 72px;
            height: 72px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            margin: -36px auto 1.5rem; /* Floating effect like dashboard */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .input-focus:focus {
            border-color: #FF9933;
            box-shadow: 0 0 0 4px rgba(255, 153, 51, 0.1);
        }
    </style>
</head>
<body class="min-h-screen font-sans text-slate-custom pb-20">

    <!-- NAVIGATION -->
    <nav class="bg-white/80 backdrop-blur-md sticky top-0 z-50 border-b border-slate-200 shadow-sm">
        <div class="max-w-3xl mx-auto px-6 py-4 flex justify-between items-center">
            <button onclick="history.back()" class="w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 transition-colors">
                <i class="fa-solid fa-arrow-left text-flag-navy"></i>
            </button>
            <div class="flex items-center gap-2">
                <img src="https://upload.wikimedia.org/wikipedia/commons/5/55/Emblem_of_India.svg" class="h-8">
                <span class="font-extrabold uppercase tracking-tight text-flag-navy">Saarthi Governance</span>
            </div>
            <button onclick="toggleLang()" id="lang-btn" class="text-[10px] font-black px-3 py-1.5 border-2 border-flag-navy rounded-xl uppercase">हिन्दी</button>
        </div>
    </nav>

    <main class="max-w-xl mx-auto px-6 pt-12 space-y-12">

        <!-- SECTION 1: APPLICANT PROFILE (AUTO-FILLED) -->
        <div class="saarthi-card p-8">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-[10px] font-black uppercase tracking-widest text-slate-400">Applicant Identity</h3>
                <span class="bg-green-100 text-flag-green px-3 py-1 rounded-full text-[10px] font-bold border border-green-200">
                    <i class="fa-solid fa-user-check"></i> Aadhaar Verified
                </span>
            </div>
            
            <div class="grid grid-cols-2 gap-4">
                <div class="p-4 bg-slate-50/50 rounded-2xl border border-slate-100">
                    <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1">Name</label>
                    <p class="font-extrabold text-flag-navy">{{ name if name else 'Aisha' }}</p>
                </div>
                <div class="p-4 bg-slate-50/50 rounded-2xl border border-slate-100">
                    <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1">Phone</label>
                    <p class="font-extrabold text-flag-navy">{{ phone if phone else '+91 98XXX XX123' }}</p>
                </div>
                <div class="p-4 bg-slate-50/50 rounded-2xl border border-slate-100 col-span-2">
                    <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1">Email Address</label>
                    <p class="font-extrabold text-flag-navy">{{ email if email else 'aisha@governance.in' }}</p>
                </div>
            </div>
        </div>

        <!-- SECTION 2: DYNAMIC FORM CARD -->
        <div class="saarthi-card p-8 pt-0 mt-20 relative" id="form-container">
            <div id="service-icon-box" class="icon-circle grad-orange">
                <i id="service-icon" class="fa-solid fa-bolt"></i>
            </div>

            <div class="text-center mb-10">
                <h2 id="service-title" class="text-2xl font-black text-flag-navy">Electricity Bill</h2>
                <p class="text-[10px] font-black text-flag-saffron uppercase tracking-[0.3em] mt-1">Application Phase</p>
            </div>

            <div id="dynamic-fields" class="space-y-8">
                <!-- JS Injects Fields Here -->
            </div>
        </div>

        <!-- SECTION 3: ACTION -->
        <div class="pt-4">
            <button onclick="handleSubmit()" id="submit-btn" class="w-full bg-flag-green text-white py-6 rounded-[2rem] text-xl font-black shadow-xl shadow-green-900/30 hover:bg-green-800 active:scale-[0.98] transition-all flex items-center justify-center gap-4">
                SUBMIT APPLICATION
                <i class="fa-solid fa-paper-plane"></i>
            </button>
        </div>

    </main>

    <!-- SUCCESS MODAL -->
    <div id="success-modal" class="fixed inset-0 bg-flag-white/90 backdrop-blur-md z-[100] hidden flex items-center justify-center p-6 text-center">
        <div class="bg-white rounded-[3rem] p-10 max-w-sm w-full shadow-2xl border-b-8 border-flag-green">
            <div class="w-24 h-24 grad-green text-white rounded-[2rem] flex items-center justify-center mx-auto mb-6 text-5xl rotate-6">
                <i class="fa-solid fa-check-double"></i>
            </div>
            <h2 class="text-3xl font-black text-flag-navy mb-2">Done!</h2>
            <p class="text-slate-500 text-sm font-medium mb-8">Aapka aavedan safalta purvak jama ho gaya hai.</p>
            
            <div class="bg-slate-50 p-6 rounded-3xl mb-8 border-2 border-dashed border-slate-200">
                <p class="text-[10px] font-black text-slate-400 uppercase mb-1">Track ID Reference</p>
                <h3 class="text-2xl font-black text-flag-navy">#SRTH-8892</h3>
            </div>

            <button onclick="location.href='/track'" class="w-full bg-flag-navy text-white py-5 rounded-2xl font-black shadow-xl">
                LIVE TRACK STATUS
            </button>
        </div>
    </div>

    <!-- AI VERIFIER LOADER -->
    <div id="ai-loader" class="fixed inset-0 bg-white/95 z-[110] hidden flex flex-col items-center justify-center">
        <div class="w-32 h-32 mb-6">
            <lottie-player src="https://assets10.lottiefiles.com/packages/lf20_p8bfn5to.json" background="transparent" speed="1" loop autoplay></lottie-player>
        </div>
        <p class="font-black text-lg text-flag-navy uppercase tracking-widest">AI Verifying Details...</p>
        <p class="text-[10px] text-flag-saffron font-bold mt-2">Checking Govt. Secure Database</p>
    </div>

    <script>
        const serviceConfigs = {
            'electricity': { title: 'Electricity Bill', icon: 'fa-bolt', color: 'grad-orange', fields: ['Consumer Number', 'Bill Amount'] },
            'cyber': { title: 'Cyber Fraud', icon: 'fa-user-shield', color: 'grad-navy', fields: ['Transaction ID', 'Amount Lost'] },
            'water': { title: 'Water Connection', icon: 'fa-droplet', color: 'grad-blue', fields: ['Connection ID', 'Area Code'] },
            'scholarship': { title: 'Scholarship', icon: 'fa-graduation-cap', color: 'grad-green', fields: ['Student ID', 'Institute Name'] },
            'aadhaar': { title: 'Aadhaar Update', icon: 'fa-fingerprint', color: 'grad-orange', fields: ['Enrollment ID', 'Update Reason'] },
            'voter': { title: 'Voter ID', icon: 'fa-id-card', color: 'grad-green', fields: ['EPIC Number', 'Constituency'] }
        };

        const urlParams = new URLSearchParams(window.location.search);
        const type = urlParams.get('type') || 'electricity';
        const config = serviceConfigs[type];

        function initForm() {
            if (!config) return;
            document.getElementById('service-title').innerText = config.title;
            document.getElementById('service-icon').className = `fa-solid ${config.icon}`;
            document.getElementById('service-icon-box').className = `icon-circle ${config.color}`;

            const fieldBox = document.getElementById('dynamic-fields');
            config.fields.forEach(f => {
                fieldBox.innerHTML += `
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <label class="text-xs font-black text-slate-500 uppercase tracking-widest">${f}</label>
                            <button onclick="speak('${f}')" class="text-flag-saffron text-[10px] font-black uppercase flex items-center gap-1.5 bg-orange-50 px-3 py-1.5 rounded-lg border border-orange-100">
                                <i class="fa-solid fa-volume-high"></i> Voice Help
                            </button>
                        </div>
                        <div class="relative group">
                            <input type="text" id="input-${f}" class="w-full p-5 bg-white border-2 border-slate-100 rounded-2xl font-extrabold text-lg text-flag-navy input-focus transition-all" placeholder="Enter ${f}">
                            <button onclick="startSTT('input-${f}')" class="absolute right-4 top-1/2 -translate-y-1/2 w-12 h-12 rounded-xl bg-flag-navy text-white flex items-center justify-center shadow-lg active:scale-90 transition-all">
                                <i class="fa-solid fa-microphone"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const speech = new SpeechSynthesisUtterance(text);
            speech.lang = 'hi-IN';
            window.speechSynthesis.speak(speech);
        }

        function startSTT(id) {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'en-IN';
            recognition.start();
            recognition.onresult = (e) => { document.getElementById(id).value = e.results[0][0].transcript; };
        }

        function handleSubmit() {
            document.getElementById('ai-loader').classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('ai-loader').classList.add('hidden');
                document.getElementById('success-modal').classList.remove('hidden');
            }, 3000);
        }

        window.onload = initForm;
    </script>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
</body>
</html>